<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Quiz Game</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="theme/bootstrap.css" media="screen">
    <style>
        form {
            background-color: darkgrey;
            padding-left: 20px;
        }

        #next-button {
            margin-top: 20px;
        }

        #progress {
            margin-top: 10px;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="jumbotron">
            <h1>Quiz Game</h1>
            <p>This is a simple quiz game to test your intelligence.</p>
            <p><a class="btn btn-primary btn-lg" id="start-button">Let's Start</a></p>

            <div id="form" class="">
                <form id="newform">
                    <!--   <div id="question" class="lead"></div>-->

                </form>
                <button value="submit" class="btn btn-primary" id="next-button"></button>
                <div class="progress progress-striped active" id="progress">
                    <div class="progress-bar pt-5 lead pb-5" id="progress-bar"></div>
                </div>
            </div>

            <div id="result"></div>
            <a class="btn btn-info" href="/" id="reset-button">Reset</a>
        </div>
    </div>

    <script src="jquery.js"></script>
    <script>

        $("#form").hide();
        $("#reset-button").hide();
        $("#pagination").hide();
        $("#pagination-demo").hide();
        var questionTag = $("#question");

        var currentQuestion = 0;
        var correctAnswers = 0;
        var userAnswers = [];

        var questionList = [
            {
                question: "What is the color of water?",
                options: [
                    "White",
                    "Green",
                    "Colourless",
                    "Blue"
                ],
                answer: "2"
            },
            {
                question: "India is a ?",
                options: [
                    "City",
                    "State",
                    "Village",
                    "Country"
                ],
                answer: "3"
            },
            {
                question: "What is 24+3",
                options: [
                    "27",
                    "26",
                    "25",
                    "28"
                ],
                answer: "0"
            }
        ];

        $("#start-button").click(function (event) {
            event.preventDefault();

            loadAllQuestion();
            bindClick();
            loadQuestion(currentQuestion);
            loadPageScroll();
            $(this).hide();

        });

        $("#next-button").click(function () {
            event.preventDefault();
            currentQuestion++;;
            if (currentQuestion === questionList.length) {
                showResult();
            } else loadQuestion(currentQuestion);
        });

        function storeUserAnswer(currentQuestion) {
            if ($("input[name='option" + (currentQuestion + 1) + "']:checked").val()) {
                userAnswers[currentQuestion] = $("input[name=option]:checked").val();

                var answerCount = userAnswers.filter(a=>a !== 'undefined').length;
                var widthOfProgressBar = (answerCount / questionList.length) * 100 + "%";
                $("#progress-bar").css("width", widthOfProgressBar);
                $("#progress-bar").html(answerCount + "/" + questionList.length + " questions answered");
            };
        };

        function bindClick() {
            $('input[type="radio"]').click(function () {
                if ($(this).is(':checked')) {
                    storeUserAnswer(currentQuestion);
                }
            });
        }

        function loadAllQuestion() {
            for (var i = 0; i < questionList.length; i++) {
                var $options = "";
                for (var j in questionList[i].options) {
                    if (questionList[i].options.hasOwnProperty(j)) {
                        $options += ("<label><input type='radio' name='option" + (i + 1) + "' value=" + j + " id='option" + j + "'>&nbsp"
                            + questionList[i].options[j] + "</label><br>");
                    }
                }
                var $question = $("<div id='question" + (i) + "' class='lead'><p>" + (i + 1) + "." + questionList[i].question + "</p>" + $options + "</div>");
                $question.appendTo("#newform");
            }
            $("#form").show();
        };

        function loadQuestion(questionToLoad) {
            currentQuestion = questionToLoad;
            if (currentQuestion === questionList.length - 1) {
                $('#next-button').text("Submit");
                $('#next-button').addClass("btn-success");
            } else {
                $('#next-button').removeClass("btn-success");
                $('#next-button').text("Next");
            }

            $(".page-item").removeClass("active");
            $("#pageNumber" + (questionToLoad + 1)).addClass("active");

            $("#newform").children().hide();
            $("#question" + questionToLoad + "").show();
        }

        function showResult() {
            for (var i = 0; i < questionList.length; i++) {
                if (userAnswers[i] === questionList[i].answer) {
                    correctAnswers++;
                };
            };

            var $result = $("<p class='alert alert-dismissable alert-success'>You have scored " +
                correctAnswers + " out of " + questionList.length + "</p>");
            $result.appendTo($("#result"));

            $("#reset-button").show();
            $("#form").hide();
            $("#start-button").hide();

        }

        function loadPageScroll() {
            var $pagination = $("<ul class='pagination'>");

            for (var i = 0; i < questionList.length; i++) {
                var questionNumber = i + 1;
                var $pageNumber = $("<li class= 'page-item' id='pageNumber" + questionNumber + "'><a href='#' onclick='loadQuestion(" + i + ")'>"
                                  + questionNumber + "</a></li>");
                $pageNumber.appendTo($pagination);
            }
            $pagination.appendTo($("#form"));
            $("#pageNumber1").addClass("active");
        }
    </script>
</body>
</html>
